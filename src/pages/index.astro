---
import bezierEasing from "bezier-easing";
import { getCollection } from "astro:content";

import * as description from "@/description.md";

import BtrixCollection from "../components/BtrixCollection.astro";
import Layout from "../layouts/Layout.astro";

import WebrecorderLogo from "@webrecorder/hickory/icons/brand/webrecorder-icon-color.svg";
import WebrecorderLockup from "@webrecorder/hickory/icons/brand/webrecorder-lockup-color.svg";
import BrowsertrixLogo from "@webrecorder/hickory/icons/brand/browsertrix-icon-color.svg";
import AWPLogo from "@webrecorder/hickory/icons/brand/archivewebpage-icon-color.svg";

let collections = await getCollection("collections");

const ease = bezierEasing(0.4, 0, 1, 1);
const easeMap = (index: number, min: number, max: number) =>
  min + ease(index / max) * (max - min);
---

<Layout>
  <div
    class="mt-8 grid gap-8 px-8 pb-16 md:mt-16 md:grid-cols-[repeat(auto-fill,minmax(300px,1fr))] md:px-16"
  >
    <header
      class="[&_a]:link col-start-1 -col-end-2 flex flex-col gap-6 text-sm"
    >
      <h1
        class="card py-2 text-pretty has-[a[href]:hover]:ring-stone-100 contrast-more:has-[a[href]:hover]:ring-black dark:has-[a[href]:hover]:ring-stone-700 contrast-more:dark:text-white contrast-more:dark:has-[a[href]:hover]:ring-white"
      >
        Selected archives from the <a
          href="https://app.browsertrix.com/explore/usgov-archive"
          ><span class="inline-block">
            <WebrecorderLogo
              class="me-1 inline h-[1cap] overflow-visible align-baseline"
              width={null}
              height={null}
              aria-label="Webrecorder logo"
            />Webrecorder</span
          > US Government Web Archive</a
        >
      </h1>
      <div
        class="card contrast-more:black:text-white py-3 leading-6 text-pretty text-stone-500 has-[a[href]:hover]:ring-stone-100 contrast-more:text-black contrast-more:has-[a[href]:hover]:ring-black dark:has-[a[href]:hover]:ring-stone-700 contrast-more:dark:text-white contrast-more:dark:has-[a[href]:hover]:ring-white [&_p]:max-w-screen-md [&_p]:not-first-of-type:mt-2"
      >
        <description.Content />
        <p>
          Crawled with <a href="https://webrecorder.net/browsertrix/"
            ><span class="inline-block">
              <BrowsertrixLogo
                class="me-1 inline h-[1.1cap] overflow-visible align-baseline"
                width={null}
                height={null}
                aria-label="Browsertrix logo"
              />Browsertrix
            </span></a
          > and <a href="https://webrecorder.net/browsertrix/"
            ><span class="inline-block">
              <AWPLogo
                class="me-1 inline h-[1.1cap] overflow-visible align-baseline"
                width={null}
                height={null}
                aria-label="Archive Webpage logo"
              />Archive Webpage</span
            ></a
          >.
        </p>
      </div>
    </header>
    <a
      class="card card-link order-9999 -col-start-2 -col-end-1 flex flex-col justify-end gap-2 text-sm md:order-0"
      href="https://webrecorder.net"
    >
      A project by
      <WebrecorderLockup
        width={null}
        height={null}
        class="block w-full max-w-64 text-black dark:text-stone-50"
      />
    </a>
    {
      collections.map((collection, index) => (
        <BtrixCollection
          {...collection.data}
          index={easeMap(index, 1, collections.length)}
        />
      ))
    }
  </div>
</Layout>
